{
    "version": "0.14.3",
    "description": "Open source technology based on Zhongzhou rhyme input method engine/Rime Input Method Engine.",
    "homepage": "https://rime.im",
    "license": {
        "identifier": "GPL-3.0-or-later",
        "url": "https://github.com/rime/weasel/raw/master/LICENSE.txt"
    },
    "depends": "autohotkey",
    "url": "https://github.com/rime/weasel/releases/download/0.14.3/weasel-0.14.3.0-installer.exe#/installer.exe",
    "hash": "de63dc2ef45d5b094a239fc704051270f3185bf9e883132532b7e17d2fdaf81b",
    "pre_install": [
        "if (!(Test-Path \"$persist_dir\\appdata\") -and (Test-Path \"$env:APPDATA\\Rime\")) {",
        "    Copy-Item \"$env:APPDATA\\Rime\" \"$persist_dir\\appdata\" -ErrorAction SilentlyContinue -Recurse -Force",
        "}",
        "ensure \"$persist_dir\\appdata\" | Out-Null",
        "Remove-Item \"$env:APPDATA\\Rime\" -ErrorAction 'SilentlyContinue' -Recurse -Force",
        "New-Item \"$env:APPDATA\\Rime\" -ItemType Junction -Target \"$persist_dir\\appdata\" | Out-Null"
    ],
    "installer": {
        "script": [
            "Start-Process \"$dir\\installer.exe\" -ArgumentList \"/S /D=$dir\" -WorkingDirectory \"$dir\"",
            "Start-Sleep -s 8",
            "# https://github.com/chtof/chocolatey-packages/blob/master/automatic/weasel/tools/chocolateyinstall.ahk",
            "Copy-Item \"$bucketsdir\\tian\\scripts\\weasel\\install.ahk\" \"$dir\\install.ahk\" -ErrorAction 'SilentlyContinue' -Force | Out-Null",
            "Start-Process \"autohotkey\" -Verb runas -ArgumentList \"`\"$dir\\install.ahk`\"\""
        ]
    },
    "post_install": [
        "if (Test-Path \"$persist_dir\\data\") { Copy-Item \"$persist_dir\\data\\*\" \"$dir\\weasel-$version\\data\" -ErrorAction 'SilentlyContinue' -Force -Recurse }",
        "Start-Sleep -s 8",
        "$weasel_startmenu_folder = [System.IO.Path]::Combine([Environment]::GetFolderPath('CommonStartMenu'), 'Programs', '小狼毫輸入法')",
        "if ($global) { $startmenu = 'CommonStartMenu' } else { $startmenu = 'StartMenu' }",
        "$scoop_startmenu_folder = [System.IO.Path]::Combine([Environment]::GetFolderPath($startmenu), 'Programs', 'Scoop Apps')",
        "Move-Item \"$weasel_startmenu_folder\" \"$scoop_startmenu_folder\\\" -ErrorAction 'SilentlyContinue' -Force",
        "Remove-Item \"$dir\\installer.exe\""
    ],
    "uninstaller": {
        "script": [
            "ensure \"$persist_dir\\data\" | Out-Null",
            "Copy-Item \"$dir\\weasel-$version\\data\\*\" \"$persist_dir\\data\" -Force -Recurse",
            "Start-Process \"$dir\\weasel-$version\\uninstall.exe\" -ArgumentList '/S' -Wait",
            "if ($global) { $startmenu = 'CommonStartMenu' } else { $startmenu = 'StartMenu' }",
            "$scoop_startmenu_folder = [System.IO.Path]::Combine([Environment]::GetFolderPath($startmenu), 'Programs', 'Scoop Apps')",
            "Remove-Item \"$scoop_startmenu_folder\\小狼毫輸入法\" -ErrorAction SilentlyContinue -Force -Recurse",
            "Remove-Item \"$env:APPDATA\\Rime\" -ErrorAction 'SilentlyContinue' -Force -Recurse"
        ]
    },
    "checkver": {
        "github": "https://github.com/rime/weasel"
    },
    "autoupdate": {
        "url": "https://github.com/rime/weasel/releases/download/$version/weasel-$version.0-installer.exe#/installer.exe"
    }
}
